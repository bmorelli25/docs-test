<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Explore logs" href="view-and-monitor-logs.html" /><link rel="prev" title="Parse and route logs" href="parse-log-data.html" />

    <!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06.dev1 -->
        <title>Filter and aggregate logs - Elastic documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=4a3d756c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <!-- DESKTOP HEADER -->
  <header class="header">
    <a class="header__logo" href="#">CWK</a>
    <div class="header__toggle">
        <i class="bx bx-menu" id="header-toggle"></i>
    </div>
    <nav class="nav" id="nav-menu">
        <div class="nav__content bg-grid">
            <a class="nav__profil" href="#">
                <div class="nav__img">
                    <img src="https://codwerk.github.io/assets/images/logo_codwerk-new.png" alt="" />
                </div>
                <div>
                    <span class="nav__name">Elastic Docs</span>
                </div>
            </a>
            <div class="nav__menu">
                <ul class="nav__list">
                    <li class="nav__item"><a class="nav__link" href="#">Get Started</a></li>
                    <li class="nav__item dropdown">
                        <a class="nav__link dropdown__link" href="#">
                            Solutions<i class="bx bx-chevron-down dropdown__icon"></i>
                            <ul class="dropdown__menu">
                                <li class="dropdown__item">
                                    <a class="nav__link" href="#">Search</a>
                                </li>
                                <li class="dropdown__item">
                                    <a class="nav__link" href="#">Security</a>
                                </li>
                                <li class="dropdown__item">
                                    <a class="nav__link" href="#">Observability</a>
                                </li>
                            </ul>
                        </a>
                    </li>
                    <li class="nav__item dropdown">
                      <a class="nav__link dropdown__link" href="#">
                          Platform
                          <i class="bx bx-chevron-down dropdown__icon"></i>
                          <ul class="dropdown__menu">
                              <li class="dropdown__item">
                                  <a class="nav__link" href="#">Elasticsearch</a>
                              </li>
                              <li class="dropdown__item">
                                  <a class="nav__link" href="#">Logstash</a>
                              </li>
                              <li class="dropdown__item">
                                  <a class="nav__link" href="#">Beats</a>
                              </li>
                          </ul>
                      </a>
                  </li>
                    <li class="nav__item dropdown">
                        <a class="nav__link dropdown__link" href="#">
                            API
                            <i class="bx bx-chevron-down dropdown__icon"></i>
                            <ul class="dropdown__menu">
                                <li class="dropdown__item">
                                    <a class="nav__link" href="#">Elasticsearch</a>
                                </li>
                                <li class="dropdown__item">
                                    <a class="nav__link" href="#">Logstash</a>
                                </li>
                                <li class="dropdown__item">
                                    <a class="nav__link" href="#">Beats</a>
                                </li>
                            </ul>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a class="nav__link" href="#">Release Docs</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

  <!-- MOBILE HEADER -->
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Elastic  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Elastic  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search me" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Observability</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Observability</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../observability-overview.html">Observability overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elastic-entity-model.html">Elastic Entity Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/create-an-observability-project.html">Create an Elastic Observability project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/billing.html">Observability billing dimensions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apm/index.html">Application performance monitoring (APM)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Application performance monitoring (APM)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-distributed-tracing.html">Distributed tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-metrics.html">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-stacktrace-collection.html">Stacktrace collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-create-custom-links.html">Create custom links</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-data-types.html">APM data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-overview.html">Navigate the Applications UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-reference.html">Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-get-started.html">Get started with traces and APM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-kibana-settings.html">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-logs.html">Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-transaction-sampling.html">Transaction sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-observe-lambda-functions.html">Observe Lambda functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-service-overview.html">Service Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-transactions.html">Transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-track-deployments-with-annotations.html">Track deployments with annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-traces.html">Traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/new-experience-services.html">New services experience</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-query-your-data.html">Query your data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-errors.html">Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-filter-your-data.html">Filter your data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-reduce-your-data-usage.html">Reduce your data usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-view-and-analyze-traces.html">View and analyze traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-service-map.html">Service map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-services.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-integrate-with-machine-learning.html">Integrate with machine learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-troubleshooting/common-problems.html">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-troubleshooting/common-problems.html#no-data-is-indexed">No data is indexed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-troubleshooting/common-response-codes.html">Troubleshooting two</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-troubleshooting/common-response-codes.html#http-400-data-decoding-error-data-validation-error">HTTP 400: Data decoding error / Data validation error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-send-traces-to-elastic.html">Send APM data to Elastic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-transaction-sampling/configure-head-based-sampling.html">tran sampl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-transaction-sampling/configure-head-based-sampling.html#id1">tran sampl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-compress-spans.html">Compress spans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-find-transaction-latency-and-failure-correlations.html">Find transaction latency and failure correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-dependencies.html">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-trace-sample-timeline.html">Trace sample timeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-server-api.html">Managed intake service event API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-ui-infrastructure.html">Infrastructure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm/apm-keep-data-secure.html">Keep APM data secure</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Log monitoring</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Log monitoring</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="get-started-with-logs.html">Get started with system logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="stream-log-files.html">Stream any log file</a></li>
<li class="toctree-l3"><a class="reference internal" href="correlate-application-logs.html">Stream application logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="plaintext-application-logs.html">Plaintext application logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="ecs-application-logs.html">ECS formatted application logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="send-application-logs.html">PRODUCT_NAME log sending</a></li>
<li class="toctree-l3"><a class="reference internal" href="parse-log-data.html">Parse and route logs</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Filter and aggregate logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="view-and-monitor-logs.html">Explore logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="monitor-datasets.html">Monitor log data set quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="add-logs-service-name.html">Add a service name to logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="run-log-pattern-analysis.html">Run a pattern analysis on log data</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshoot-logs.html">Troubleshoot logs</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../synthetics/index.html">Synthetics</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Synthetics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-lightweight.html">Configure lightweight monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-manage-monitors.html">Manage monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-get-started-ui.html">Create monitors in the Synthetics UI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-scale-and-architect.html">Scale and architect a Synthetics deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-create-test.html">Write a synthetic test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-manage-retention.html">Manage data retention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-configuration.html">Configure a Synthetics project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-params-secrets.html">Work with params and secrets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-settings.html">Configure Synthetics settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-get-started-project.html">Create monitors with a Synthetics project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-command-reference.html">Use the Synthetics CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-intro.html">Synthetic monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-journeys.html">Scripting browser monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-private-location.html">Monitor resources on private networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-recorder.html">Use the Synthetics Recorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-recorder.html#record-a-journey">Record a journey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-recorder.html#edit-a-journey">Edit a journey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-recorder.html#test-the-journey">Test the journey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-recorder.html#export">Export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-analyze.html">Analyze data from synthetic monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-troubleshooting.html">Troubleshooting Synthetics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-monitor-use.html">Configure individual browser monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-feature-roles.html">Grant users access to secured resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../synthetics/synthetics-security-encryption.html">Synthetics Encryption and Security</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../alerting/index.html">Create and manage rules</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Create and manage rules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-slo-burn-rate-alert-rule.html">Create an SLO burn rate rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/triage-threshold-breaches.html">Triage threshold breaches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/view-alerts.html">View alerts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-inventory-threshold-alert-rule.html">Create an inventory rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/alerting.html">Alerting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/aiops-generate-anomaly-alerts.html">Create an anomaly detection rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-anomaly-alert-rule.html">Create an APM anomaly rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/aggregation-options.html">Aggregation options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-latency-threshold-alert-rule.html">Create a latency threshold rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/triage-slo-burn-rate-breaches.html">Triage SLO burn rate breaches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-elasticsearch-query-alert-rule.html">Create an Elasticsearch query rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-custom-threshold-alert-rule.html">Create a custom threshold rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/alerting-connectors.html">Alerting connectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-error-count-threshold-alert-rule.html">Create an error count threshold rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/create-failed-transaction-rate-threshold-alert-rule.html">Create a failed transaction rate threshold rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../alerting/rate-aggregation.html">Rate aggregation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cases/index.html">Cases</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Cases</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cases/manage-cases-settings.html">Configure case settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cases/create-manage-cases.html">Create and manage cases</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../unsorted/index.html">Unsorted</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Unsorted</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-elastic-apm-agents.html">Elastic APM agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-opentelemetry-collect-metrics.html">Collect metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-opentelemetry-resource-attributes.html">Resource attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-opentelemetry-opentelemetry-apisdk-with-elastic-apm-agents.html">OpenTelemetry API/SDK with Elastic APM agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-opentelemetry-limitations.html">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-aws-lambda-functions.html">AWS Lambda functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-opentelemetry.html">OpenTelemetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-opentelemetry-opentelemetry-native-support.html">OpenTelemetry native support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apm-agents/apm-agents-opentelemetry-other-execution-environments.html">AWS Lambda support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops-detect-anomalies.html">Detect anomalies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops-detect-anomalies.html#create-and-run-an-anomaly-detection-job">Create and run an anomaly detection job</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops-detect-anomalies.html#view-the-results">View the results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops-forecast-anomaly.html">Forecast future behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops-tune-anomaly-detection-job.html">Tune your anomaly detection job</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops-detect-change-points.html">Detect change points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops-analyze-spikes.html">Analyze log spikes and drops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aiops/aiops.html">AIOps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dashboards/dashboards-and-visualizations.html">Dashboards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/metrics-app-fields.html">Required fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/get-started-with-metrics.html">Get started with system metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/metrics-reference.html">Metrics reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/analyze-hosts.html">Analyze and compare hosts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/detect-metric-anomalies.html">Detect metric anomalies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/kubernetes-pod-metrics.html">Kubernetes pod metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/configure-infra-settings.html">Configure settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/docker-container-metrics.html">Docker container metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/view-infrastructure-metrics.html">View infrastructure metrics by resource type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/host-metrics.html">Host metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/aws-metrics.html">AWS metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../infra-monitoring/infra-monitoring.html">Infrastructure monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ai-assistant/ai-assistant.html">AI Assistant</a></li>
<li class="toctree-l3"><a class="reference internal" href="../slos/slos.html">SLOs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../slos/create-an-slo.html">Create an SLO</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../search/index.html">Elastic Search</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Elastic Search</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../search/bucket-1/index.html">Bucket 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../search/bucket-2/index.html">Bucket 2</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../sec/index.html">Elastic Security</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Elastic Security</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sec/bucket-1/index.html">Bucket 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sec/bucket-2/index.html">Bucket 2</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/obs/logging/filter-and-aggregate-logs.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="filter-and-aggregate-logs">
<h1>Filter and aggregate logs<a class="headerlink" href="#filter-and-aggregate-logs" title="Link to this heading">¶</a></h1>
<p><DocBadge template="technical preview" /></p>
<p>Filter and aggregate your log data to find specific information, gain insight, and monitor your systems more efficiently. You can filter and aggregate based on structured fields like timestamps, log levels, and IP addresses that you’ve extracted from your log data.</p>
<p>This guide shows you how to:</p>
<ul class="simple">
<li><p><DocLink slug="/serverless/observability/filter-and-aggregate-logs" section="filter-logs">Filter logs</DocLink>: Narrow down your log data by applying specific criteria.</p></li>
<li><p><DocLink slug="/serverless/observability/filter-and-aggregate-logs" section="aggregate-logs">Aggregate logs</DocLink>: Analyze and summarize data to find patterns and gain insight.</p></li>
</ul>
<div id="logs-filter-and-aggregate-prereq"></div>
<section id="before-you-get-started">
<h2>Before you get started<a class="headerlink" href="#before-you-get-started" title="Link to this heading">¶</a></h2>
<p>import Roles from ‘../partials/roles.mdx’</p>
<Roles role="Admin" goal="create ingest pipelines and set the index template" />
<p>The examples on this page use the following ingest pipeline and index template, which you can set in <strong>Developer Tools</strong>. If you haven’t used ingest pipelines and index templates to parse your log data and extract structured fields yet, start with the <DocLink slug="/serverless/observability/parse-log-data">Parse and organize logs</DocLink> documentation.</p>
<p>Set the ingest pipeline with the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">PUT _ingest/pipeline/logs-example-default</span>
<span class="go">{</span>
<span class="go">  &quot;description&quot;: &quot;Extracts the timestamp log level and host ip&quot;,</span>
<span class="go">  &quot;processors&quot;: [</span>
<span class="go">    {</span>
<span class="go">      &quot;dissect&quot;: {</span>
<span class="go">        &quot;field&quot;: &quot;message&quot;,</span>
<span class="go">        &quot;pattern&quot;: &quot;%{@timestamp} %{log.level} %{host.ip} %{message}&quot;</span>
<span class="go">      }</span>
<span class="go">    }</span>
<span class="go">  ]</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Set the index template with the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">PUT _index_template/logs-example-default-template</span>
<span class="go">{</span>
<span class="go">  &quot;index_patterns&quot;: [ &quot;logs-example-*&quot; ],</span>
<span class="go">  &quot;data_stream&quot;: { },</span>
<span class="go">  &quot;priority&quot;: 500,</span>
<span class="go">  &quot;template&quot;: {</span>
<span class="go">    &quot;settings&quot;: {</span>
<span class="go">      &quot;index.default_pipeline&quot;:&quot;logs-example-default&quot;</span>
<span class="go">    }</span>
<span class="go">  },</span>
<span class="go">  &quot;composed_of&quot;: [</span>
<span class="go">    &quot;logs-mappings&quot;,</span>
<span class="go">    &quot;logs-settings&quot;,</span>
<span class="go">    &quot;logs@custom&quot;,</span>
<span class="go">    &quot;ecs@dynamic_templates&quot;</span>
<span class="go">  ],</span>
<span class="go">  &quot;ignore_missing_component_templates&quot;: [&quot;logs@custom&quot;]</span>
<span class="go">}</span>
</pre></div>
</div>
<div id="logs-filter"></div>
</section>
<section id="filter-logs">
<h2>Filter logs<a class="headerlink" href="#filter-logs" title="Link to this heading">¶</a></h2>
<p>Filter your data using the fields you’ve extracted so you can focus on log data with specific log levels, timestamp ranges, or host IPs. You can filter your log data in different ways:</p>
<ul class="simple">
<li><p><DocLink slug="/serverless/observability/filter-and-aggregate-logs" section="filter-logs-in-logs-explorer">Filter logs in Logs Explorer</DocLink>: Filter and visualize log data in Logs Explorer.</p></li>
<li><p><DocLink slug="/serverless/observability/filter-and-aggregate-logs" section="filter-logs-with-query-dsl">Filter logs with Query DSL</DocLink>: Filter log data from Developer Tools using Query DSL.</p></li>
</ul>
<div id="logs-filter-logs-explorer"></div>
<section id="filter-logs-in-logs-explorer">
<h3>Filter logs in Logs Explorer<a class="headerlink" href="#filter-logs-in-logs-explorer" title="Link to this heading">¶</a></h3>
<p>Logs Explorer is a tool that automatically provides views of your log data based on integrations and data streams. To open Logs Explorer, go to <strong>Discover</strong> and select the <strong>Logs Explorer</strong> tab.</p>
<p>From Logs Explorer, you can use the <a class="reference external" href="http://example.co">(PRODUCT_NAME) Query Language (KQL)</a>/kuery-query.html) in the search bar to narrow down the log data that’s displayed.
For example, you might want to look into an event that occurred within a specific time range.</p>
<p>Add some logs with varying timestamps and log levels to your data stream:</p>
<ol class="arabic simple">
<li><p>In your Observability project, go to <strong>Developer Tools</strong>.</p></li>
<li><p>In the <strong>Console</strong> tab, run the following command:</p></li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">POST logs-example-default/_bulk</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-15T08:15:20.234Z WARN 192.168.1.101 Disk usage exceeds 90%.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-14T10:30:45.789Z ERROR 192.168.1.102 Critical system failure detected.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-10T14:20:45.789Z ERROR 192.168.1.105 Database connection lost.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-20T09:40:32.345Z INFO 192.168.1.106 User logout initiated.&quot; }</span>
</pre></div>
</div>
<p>For this example, let’s look for logs with a <code class="docutils literal notranslate"><span class="pre">WARN</span></code> or <code class="docutils literal notranslate"><span class="pre">ERROR</span></code> log level that occurred on September 14th or 15th. From Logs Explorer:</p>
<ol class="arabic">
<li><p>Add the following KQL query in the search bar to filter for logs with log levels of <code class="docutils literal notranslate"><span class="pre">WARN</span></code> or <code class="docutils literal notranslate"><span class="pre">ERROR</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>log.level: (&quot;ERROR&quot; or &quot;WARN&quot;)
</pre></div>
</div>
</li>
<li><p>Click the current time range, select <strong>Absolute</strong>, and set the <strong>Start date</strong> to <code class="docutils literal notranslate"><span class="pre">Sep</span> <span class="pre">14,</span> <span class="pre">2023</span> <span class="pre">&#64;</span> <span class="pre">00:00:00.000</span></code>.</p>
 <DocImage size="l" url="../images/logs-start-date.png" alt="Set the time range start date" />
</li>
<li><p>Click the end of the current time range, select <strong>Absolute</strong>, and set the <strong>End date</strong> to <code class="docutils literal notranslate"><span class="pre">Sep</span> <span class="pre">15,</span> <span class="pre">2023</span> <span class="pre">&#64;</span> <span class="pre">23:59:59.999</span></code>.</p>
 <DocImage size="l" url="../images/logs-end-date.png" alt="Set the time range end date" />
</li>
</ol>
<p>Under the <strong>Documents</strong> tab, you’ll see the filtered log data matching your query.</p>
<p><img alt="" src="../../_images/logs-kql-filter.png" /></p>
<p>For more on using Logs Explorer, refer to the <a class="reference external" href="http://example.co">Discover</a>/discover.html) documentation.</p>
<div id="logs-filter-qdsl"></div>
</section>
<section id="filter-logs-with-query-dsl">
<h3>Filter logs with Query DSL<a class="headerlink" href="#filter-logs-with-query-dsl" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="http://example.co">Query DSL</a>/query-dsl.html) is a JSON-based language that sends requests and retrieves data from indices and data streams. You can filter your log data using Query DSL from <strong>Developer Tools</strong>.</p>
<p>For example, you might want to troubleshoot an issue that happened on a specific date or at a specific time. To do this, use a boolean query with a <a class="reference external" href="http://example.co">range query</a>/query-dsl-range-query.html) to filter for the specific timestamp range and a <a class="reference external" href="http://example.co">term query</a>/query-dsl-term-query.html) to filter for <code class="docutils literal notranslate"><span class="pre">WARN</span></code> and <code class="docutils literal notranslate"><span class="pre">ERROR</span></code> log levels.</p>
<p>First, from <strong>Developer Tools</strong>, add some logs with varying timestamps and log levels to your data stream with the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">POST logs-example-default/_bulk</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-15T08:15:20.234Z WARN 192.168.1.101 Disk usage exceeds 90%.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-14T10:30:45.789Z ERROR 192.168.1.102 Critical system failure detected.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-10T14:20:45.789Z ERROR 192.168.1.105 Database connection lost.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-20T09:40:32.345Z INFO 192.168.1.106 User logout initiated.&quot; }</span>
</pre></div>
</div>
<p>Let’s say you want to look into an event that occurred between September 14th and 15th. The following boolean query filters for logs with timestamps during those days that also have a log level of <code class="docutils literal notranslate"><span class="pre">ERROR</span></code> or <code class="docutils literal notranslate"><span class="pre">WARN</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">POST /logs-example-default/_search</span>
<span class="go">{</span>
<span class="go">  &quot;query&quot;: {</span>
<span class="go">    &quot;bool&quot;: {</span>
<span class="go">      &quot;filter&quot;: [</span>
<span class="go">        {</span>
<span class="go">          &quot;range&quot;: {</span>
<span class="go">            &quot;@timestamp&quot;: {</span>
<span class="go">              &quot;gte&quot;: &quot;2023-09-14T00:00:00&quot;,</span>
<span class="go">              &quot;lte&quot;: &quot;2023-09-15T23:59:59&quot;</span>
<span class="go">            }</span>
<span class="go">          }</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">          &quot;terms&quot;: {</span>
<span class="go">            &quot;log.level&quot;: [&quot;WARN&quot;, &quot;ERROR&quot;]</span>
<span class="go">          }</span>
<span class="go">        }</span>
<span class="go">      ]</span>
<span class="go">    }</span>
<span class="go">  }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>The filtered results should show <code class="docutils literal notranslate"><span class="pre">WARN</span></code> and <code class="docutils literal notranslate"><span class="pre">ERROR</span></code> logs that occurred within the timestamp range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="o">...</span>
  <span class="s2">&quot;hits&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;hits&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;_index&quot;</span><span class="p">:</span> <span class="s2">&quot;.ds-logs-example-default-2023.09.25-000001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;JkwPzooBTddK4OtTQToP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.101 Disk usage exceeds 90%.&quot;</span><span class="p">,</span>
          <span class="s2">&quot;log&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;WARN&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;@timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-15T08:15:20.234Z&quot;</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;_index&quot;</span><span class="p">:</span> <span class="s2">&quot;.ds-logs-example-default-2023.09.25-000001&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;A5YSzooBMYFrNGNwH75O&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;192.168.1.102 Critical system failure detected.&quot;</span><span class="p">,</span>
          <span class="s2">&quot;log&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;ERROR&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;@timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-09-14T10:30:45.789Z&quot;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div id="logs-aggregate"></div>
</section>
</section>
<section id="aggregate-logs">
<h2>Aggregate logs<a class="headerlink" href="#aggregate-logs" title="Link to this heading">¶</a></h2>
<p>Use aggregation to analyze and summarize your log data to find patterns and gain insight. <a class="reference external" href="http://example.co">Bucket aggregations</a>/search-aggregations-bucket.html) organize log data into meaningful groups making it easier to identify patterns, trends, and anomalies within your logs.</p>
<p>For example, you might want to understand error distribution by analyzing the count of logs per log level.</p>
<p>First, from <strong>Developer Tools</strong>, add some logs with varying log levels to your data stream using the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">POST logs-example-default/_bulk</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-15T08:15:20.234Z WARN 192.168.1.101 Disk usage exceeds 90%.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-14T10:30:45.789Z ERROR 192.168.1.102 Critical system failure detected.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-15T12:45:55.123Z INFO 192.168.1.103 Application successfully started.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-14T15:20:10.789Z WARN 192.168.1.104 Network latency exceeding threshold.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-10T14:20:45.789Z ERROR 192.168.1.105 Database connection lost.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-20T09:40:32.345Z INFO 192.168.1.106 User logout initiated.&quot; }</span>
<span class="go">{ &quot;create&quot;: {} }</span>
<span class="go">{ &quot;message&quot;: &quot;2023-09-21T15:20:55.678Z DEBUG 192.168.1.102 Database connection established.&quot; }</span>
</pre></div>
</div>
<p>Next, run this command to aggregate your log data using the <code class="docutils literal notranslate"><span class="pre">log.level</span></code> field:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">POST logs-example-default/_search?size=0&amp;filter_path=aggregations</span>
<span class="go">{</span>
<span class="go">&quot;size&quot;: 0, \[\^\1]</span>
<span class="go">&quot;aggs&quot;: {</span>
<span class="go">    &quot;log_level_distribution&quot;: {</span>
<span class="go">      &quot;terms&quot;: {</span>
<span class="go">        &quot;field&quot;: &quot;log.level&quot;</span>
<span class="go">      }</span>
<span class="go">    }</span>
<span class="go">  }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>[^\1]: Searches with an aggregation return both the query results and the aggregation, so you would see the logs matching the data and the aggregation. Setting <code class="docutils literal notranslate"><span class="pre">size</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code> limits the results to aggregations.</p>
<p>The results should show the number of logs in each log level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;aggregations&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;error_distribution&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;doc_count_error_upper_bound&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;sum_other_doc_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;buckets&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">,</span>
          <span class="s2">&quot;doc_count&quot;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span>
          <span class="s2">&quot;doc_count&quot;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;WARN&quot;</span><span class="p">,</span>
          <span class="s2">&quot;doc_count&quot;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
          <span class="s2">&quot;doc_count&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can also combine aggregations and queries. For example, you might want to limit the scope of the previous aggregation by adding a range query:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">GET /logs-example-default/_search</span>
<span class="go">{</span>
<span class="go">  &quot;size&quot;: 0,</span>
<span class="go">  &quot;query&quot;: {</span>
<span class="go">    &quot;range&quot;: {</span>
<span class="go">      &quot;@timestamp&quot;: {</span>
<span class="go">        &quot;gte&quot;: &quot;2023-09-14T00:00:00&quot;,</span>
<span class="go">        &quot;lte&quot;: &quot;2023-09-15T23:59:59&quot;</span>
<span class="go">      }</span>
<span class="go">    }</span>
<span class="go">  },</span>
<span class="go">  &quot;aggs&quot;: {</span>
<span class="go">    &quot;my-agg-name&quot;: {</span>
<span class="go">      &quot;terms&quot;: {</span>
<span class="go">        &quot;field&quot;: &quot;log.level&quot;</span>
<span class="go">      }</span>
<span class="go">    }</span>
<span class="go">  }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>The results should show an aggregate of logs that occurred within your timestamp range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="o">...</span>
  <span class="s2">&quot;hits&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;hits&quot;</span><span class="p">:</span> <span class="p">[]</span>
  <span class="p">},</span>
  <span class="s2">&quot;aggregations&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;my-agg-name&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;doc_count_error_upper_bound&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;sum_other_doc_count&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;buckets&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;WARN&quot;</span><span class="p">,</span>
          <span class="s2">&quot;doc_count&quot;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">,</span>
          <span class="s2">&quot;doc_count&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span>
          <span class="s2">&quot;doc_count&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For more on aggregation types and available aggregations, refer to the <a class="reference external" href="http://example.co">Aggregations</a>/search-aggregations.html) documentation.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="view-and-monitor-logs.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Explore logs</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="parse-log-data.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Parse and route logs</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Elasticsearch B.V. All Rights Reserved.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Filter and aggregate logs</a><ul>
<li><a class="reference internal" href="#before-you-get-started">Before you get started</a></li>
<li><a class="reference internal" href="#filter-logs">Filter logs</a><ul>
<li><a class="reference internal" href="#filter-logs-in-logs-explorer">Filter logs in Logs Explorer</a></li>
<li><a class="reference internal" href="#filter-logs-with-query-dsl">Filter logs with Query DSL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aggregate-logs">Aggregate logs</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=140f00c8"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>